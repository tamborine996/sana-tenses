<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tenses Practice</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,500;0,600;1,400&family=Noto+Nastaliq+Urdu:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --cream: #faf7f2;
            --cream-dark: #f0ebe3;
            --ink: #1a2a2d;
            --ink-light: #3d4f52;
            --teal: #2d5a5a;
            --teal-deep: #1a4a4a;
            --amber: #c9982c;
            --amber-light: #e8c76b;
            --rose: #a85a5a;
            --rose-light: #d4a0a0;
            --sage: #7a9a8a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            font-size: 16px;
        }

        body {
            font-family: 'Cormorant Garamond', Georgia, serif;
            background: var(--cream);
            background-image:
                radial-gradient(ellipse at 20% 20%, rgba(45, 90, 90, 0.03) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(201, 152, 44, 0.04) 0%, transparent 50%);
            min-height: 100vh;
            min-height: 100dvh;
            display: flex;
            flex-direction: column;
            color: var(--ink);
        }

        /* Navigation */
        .nav {
            display: flex;
            justify-content: center;
            gap: 0;
            padding: 16px 20px;
            background: white;
            border-bottom: 1px solid rgba(26, 42, 45, 0.08);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-btn {
            padding: 10px 24px;
            border: none;
            background: transparent;
            font-family: 'Cormorant Garamond', Georgia, serif;
            font-size: 1rem;
            font-weight: 500;
            color: var(--ink-light);
            cursor: pointer;
            transition: all 0.25s ease;
            border-bottom: 2px solid transparent;
        }

        .nav-btn:hover {
            color: var(--teal);
        }

        .nav-btn.active {
            color: var(--teal-deep);
            border-bottom-color: var(--amber);
        }

        /* Main Content */
        .main {
            flex: 1;
            padding: 24px 20px;
            max-width: 600px;
            margin: 0 auto;
            width: 100%;
        }

        .view {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .view.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ========== LEARN VIEW ========== */
        .learn-intro {
            text-align: center;
            margin-bottom: 32px;
        }

        .learn-intro h1 {
            font-size: 1.75rem;
            font-weight: 500;
            color: var(--teal-deep);
            margin-bottom: 8px;
        }

        .learn-intro p {
            color: var(--ink-light);
            font-size: 1.05rem;
        }

        .tense-cards {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .tense-card {
            background: white;
            border: 1px solid rgba(26, 42, 45, 0.08);
            border-radius: 4px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.25s ease;
        }

        .tense-card:hover {
            box-shadow: 0 4px 12px rgba(26, 42, 45, 0.08);
        }

        .tense-card-header {
            padding: 16px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(26, 42, 45, 0.05);
        }

        .tense-card-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--teal-deep);
        }

        .tense-card-urdu {
            font-family: 'Noto Nastaliq Urdu', serif;
            font-size: 0.95rem;
            color: var(--ink-light);
            direction: rtl;
        }

        .tense-card-toggle {
            font-size: 1.2rem;
            color: var(--ink-light);
            transition: transform 0.3s ease;
        }

        .tense-card.open .tense-card-toggle {
            transform: rotate(180deg);
        }

        .tense-card-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease;
        }

        .tense-card.open .tense-card-content {
            max-height: 1000px;
        }

        .tense-card-body {
            padding: 20px;
        }

        .tense-formula {
            background: var(--cream);
            padding: 12px 16px;
            border-radius: 4px;
            margin-bottom: 16px;
            font-family: monospace;
            font-size: 0.95rem;
            color: var(--teal-deep);
            text-align: center;
        }

        .tense-explanation {
            font-family: 'Noto Nastaliq Urdu', serif;
            direction: rtl;
            text-align: right;
            line-height: 2.2;
            color: var(--ink);
            margin-bottom: 16px;
            font-size: 1.05rem;
        }

        .tense-when {
            margin-bottom: 16px;
        }

        .tense-when-title {
            font-weight: 600;
            color: var(--teal-deep);
            margin-bottom: 8px;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .tense-when-list {
            font-family: 'Noto Nastaliq Urdu', serif;
            direction: rtl;
            text-align: right;
            line-height: 2;
            color: var(--ink-light);
            padding-right: 20px;
        }

        .tense-when-list li {
            margin-bottom: 4px;
        }

        .tense-examples {
            border-top: 1px solid rgba(26, 42, 45, 0.08);
            padding-top: 16px;
        }

        .tense-examples-title {
            font-weight: 600;
            color: var(--teal-deep);
            margin-bottom: 12px;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .example-pair {
            margin-bottom: 12px;
            padding: 12px;
            background: var(--cream);
            border-radius: 4px;
        }

        .example-urdu {
            font-family: 'Noto Nastaliq Urdu', serif;
            direction: rtl;
            text-align: right;
            color: var(--ink);
            margin-bottom: 4px;
            font-size: 1.05rem;
        }

        .example-english {
            color: var(--teal-deep);
            font-style: italic;
        }

        /* ========== PRACTICE VIEW ========== */
        .practice-header {
            text-align: center;
            margin-bottom: 24px;
        }

        .practice-header h1 {
            font-size: 1.5rem;
            font-weight: 500;
            color: var(--teal-deep);
            margin-bottom: 8px;
        }

        .session-info {
            display: flex;
            justify-content: center;
            gap: 20px;
            color: var(--ink-light);
            font-size: 0.95rem;
        }

        .session-info span {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        /* Level selector */
        .level-selector {
            margin-bottom: 24px;
        }

        .level-selector-title {
            font-size: 0.85rem;
            color: var(--ink-light);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 12px;
            text-align: center;
        }

        .levels {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
        }

        .level-btn {
            padding: 8px 16px;
            border: 1px solid var(--teal);
            background: transparent;
            border-radius: 2px;
            font-family: 'Cormorant Garamond', Georgia, serif;
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--teal);
            cursor: pointer;
            transition: all 0.25s ease;
        }

        .level-btn:hover:not(:disabled) {
            background: rgba(45, 90, 90, 0.08);
        }

        .level-btn.active {
            background: var(--teal);
            color: var(--cream);
        }

        .level-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .level-btn.locked::after {
            content: ' ğŸ”’';
            font-size: 0.75rem;
        }

        /* Session start */
        .session-start {
            text-align: center;
            padding: 40px 20px;
            background: white;
            border-radius: 4px;
            border: 1px solid rgba(26, 42, 45, 0.08);
        }

        .session-start h2 {
            font-size: 1.3rem;
            color: var(--teal-deep);
            margin-bottom: 12px;
        }

        .session-start p {
            color: var(--ink-light);
            margin-bottom: 24px;
        }

        .session-stats-preview {
            display: flex;
            justify-content: center;
            gap: 32px;
            margin-bottom: 24px;
            padding: 16px;
            background: var(--cream);
            border-radius: 4px;
        }

        .stat-preview {
            text-align: center;
        }

        .stat-preview-value {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--teal-deep);
        }

        .stat-preview-label {
            font-size: 0.8rem;
            color: var(--ink-light);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .btn-start-session {
            background: var(--amber);
            color: var(--ink);
            border: none;
            padding: 14px 32px;
            border-radius: 2px;
            font-family: 'Cormorant Garamond', Georgia, serif;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.25s ease;
        }

        .btn-start-session:hover {
            background: var(--amber-light);
        }

        /* Card styles */
        .card-container {
            display: none;
        }

        .card-container.active {
            display: block;
        }

        .session-phase {
            text-align: center;
            margin-bottom: 16px;
            padding: 8px 16px;
            background: rgba(45, 90, 90, 0.08);
            border-radius: 2px;
            font-size: 0.85rem;
            color: var(--teal-deep);
            font-weight: 500;
        }

        .card {
            background: linear-gradient(145deg, #ffffff 0%, var(--cream) 100%);
            border: 1px solid rgba(26, 42, 45, 0.08);
            border-radius: 4px;
            padding: 36px 28px;
            min-height: 280px;
            display: flex;
            flex-direction: column;
            cursor: pointer;
            position: relative;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow:
                0 1px 2px rgba(26, 42, 45, 0.04),
                0 4px 12px rgba(26, 42, 45, 0.06);
        }

        .card::before {
            content: '';
            position: absolute;
            top: 8px;
            left: 8px;
            right: 8px;
            bottom: 8px;
            border: 1px solid rgba(201, 152, 44, 0.15);
            border-radius: 2px;
            pointer-events: none;
        }

        .card:hover:not(.revealed) {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(26, 42, 45, 0.08);
        }

        .card.revealed {
            cursor: default;
        }

        .situation {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 12px 0;
        }

        .urdu-text {
            font-family: 'Noto Nastaliq Urdu', serif;
            font-size: 1.5rem;
            font-weight: 500;
            line-height: 2.2;
            direction: rtl;
            color: var(--ink);
            transition: opacity 0.3s ease;
        }

        .card.revealed .urdu-text {
            opacity: 0.7;
        }

        .answer-section {
            margin-top: 24px;
            padding-top: 24px;
            border-top: 1px solid rgba(201, 152, 44, 0.3);
            opacity: 0;
            transform: translateY(10px);
            pointer-events: none;
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        .answer-section.visible {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
            cursor: pointer;
        }

        .english-answer {
            font-size: 1.4rem;
            font-weight: 500;
            font-style: italic;
            color: var(--teal-deep);
            text-align: center;
            margin-bottom: 16px;
            line-height: 1.5;
        }

        .tense-label-container {
            text-align: center;
            margin-bottom: 16px;
        }

        .tense-label {
            font-size: 0.75rem;
            font-weight: 600;
            letter-spacing: 0.12em;
            text-transform: uppercase;
            color: var(--amber);
            background: rgba(201, 152, 44, 0.12);
            padding: 6px 14px;
            border-radius: 2px;
            display: inline-block;
        }

        .explanation {
            font-family: 'Noto Nastaliq Urdu', serif;
            font-size: 1rem;
            color: var(--ink-light);
            text-align: center;
            direction: rtl;
            line-height: 2;
            opacity: 0.85;
        }

        .hide-hint {
            font-size: 0.75rem;
            color: var(--ink-light);
            opacity: 0.5;
            text-align: center;
            margin-top: 12px;
            font-style: italic;
        }

        .tap-hint {
            text-align: center;
            color: var(--ink-light);
            font-size: 0.85rem;
            font-style: italic;
            margin-top: 20px;
            opacity: 0.6;
        }

        .buttons {
            display: flex;
            gap: 12px;
            margin-top: 24px;
            opacity: 0;
            transform: translateY(10px);
            pointer-events: none;
            transition: opacity 0.4s ease 0.1s, transform 0.4s ease 0.1s;
        }

        .buttons.visible {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
        }

        .btn {
            flex: 1;
            padding: 14px 20px;
            border: none;
            border-radius: 2px;
            font-family: 'Cormorant Garamond', Georgia, serif;
            font-size: 0.95rem;
            font-weight: 600;
            letter-spacing: 0.06em;
            cursor: pointer;
            transition: all 0.25s ease;
        }

        .btn-wrong {
            background: rgba(168, 90, 90, 0.1);
            color: var(--rose);
            border: 1px solid var(--rose-light);
        }

        .btn-wrong:hover {
            background: var(--rose);
            color: var(--cream);
        }

        .btn-right {
            background: var(--amber);
            color: var(--ink);
            border: 1px solid var(--amber);
        }

        .btn-right:hover {
            background: var(--amber-light);
        }

        .progress-bar {
            width: 100%;
            height: 3px;
            background: rgba(26, 42, 45, 0.1);
            border-radius: 2px;
            margin-top: 24px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--teal) 0%, var(--sage) 100%);
            transition: width 0.4s ease;
        }

        /* Session Summary */
        .session-summary {
            display: none;
            text-align: center;
            padding: 32px 20px;
            background: white;
            border-radius: 4px;
            border: 1px solid rgba(26, 42, 45, 0.08);
        }

        .session-summary.active {
            display: block;
        }

        .session-summary h2 {
            font-size: 1.5rem;
            color: var(--teal-deep);
            margin-bottom: 8px;
        }

        .session-summary-subtitle {
            color: var(--ink-light);
            margin-bottom: 24px;
        }

        .summary-stats {
            display: flex;
            justify-content: center;
            gap: 32px;
            margin-bottom: 24px;
            padding: 20px;
            background: var(--cream);
            border-radius: 4px;
        }

        .summary-stat {
            text-align: center;
        }

        .summary-stat-value {
            font-size: 2rem;
            font-weight: 600;
            color: var(--teal-deep);
        }

        .summary-stat-value.good {
            color: var(--sage);
        }

        .summary-stat-value.needs-work {
            color: var(--rose);
        }

        .summary-stat-label {
            font-size: 0.8rem;
            color: var(--ink-light);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .weak-areas {
            margin-bottom: 24px;
            text-align: left;
        }

        .weak-areas-title {
            font-weight: 600;
            color: var(--teal-deep);
            margin-bottom: 12px;
            font-size: 0.9rem;
        }

        .weak-area-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 12px;
            background: rgba(168, 90, 90, 0.08);
            border-radius: 2px;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .summary-buttons {
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        .btn-secondary {
            background: transparent;
            color: var(--teal);
            border: 1px solid var(--teal);
            padding: 12px 24px;
        }

        .btn-secondary:hover {
            background: rgba(45, 90, 90, 0.08);
        }

        /* ========== PROGRESS VIEW ========== */
        .progress-header {
            text-align: center;
            margin-bottom: 32px;
        }

        .progress-header h1 {
            font-size: 1.75rem;
            font-weight: 500;
            color: var(--teal-deep);
            margin-bottom: 8px;
        }

        .progress-header p {
            color: var(--ink-light);
        }

        .overall-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin-bottom: 32px;
        }

        .overall-stat {
            background: white;
            padding: 20px;
            border-radius: 4px;
            text-align: center;
            border: 1px solid rgba(26, 42, 45, 0.08);
        }

        .overall-stat-value {
            font-size: 1.75rem;
            font-weight: 600;
            color: var(--teal-deep);
        }

        .overall-stat-label {
            font-size: 0.8rem;
            color: var(--ink-light);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .tense-progress {
            background: white;
            border-radius: 4px;
            border: 1px solid rgba(26, 42, 45, 0.08);
            overflow: hidden;
        }

        .tense-progress-title {
            padding: 16px 20px;
            font-weight: 600;
            color: var(--teal-deep);
            border-bottom: 1px solid rgba(26, 42, 45, 0.08);
        }

        .tense-progress-item {
            padding: 16px 20px;
            border-bottom: 1px solid rgba(26, 42, 45, 0.05);
        }

        .tense-progress-item:last-child {
            border-bottom: none;
        }

        .tense-progress-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .tense-progress-name {
            font-weight: 500;
            color: var(--ink);
        }

        .tense-progress-percent {
            color: var(--ink-light);
            font-size: 0.9rem;
        }

        .tense-progress-bar {
            height: 6px;
            background: var(--cream-dark);
            border-radius: 3px;
            overflow: hidden;
        }

        .tense-progress-fill {
            height: 100%;
            background: var(--teal);
            border-radius: 3px;
            transition: width 0.4s ease;
        }

        .tense-progress-fill.low {
            background: var(--rose);
        }

        .tense-progress-fill.medium {
            background: var(--amber);
        }

        .tense-progress-fill.high {
            background: var(--sage);
        }

        .reset-progress {
            margin-top: 24px;
            text-align: center;
        }

        .btn-reset {
            background: transparent;
            border: 1px solid var(--rose-light);
            color: var(--rose);
            padding: 10px 20px;
            border-radius: 2px;
            font-family: 'Cormorant Garamond', Georgia, serif;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.25s ease;
        }

        .btn-reset:hover {
            background: var(--rose);
            color: white;
        }

        /* Mobile */
        @media (max-width: 480px) {
            .nav-btn {
                padding: 10px 16px;
                font-size: 0.9rem;
            }

            .overall-stats {
                grid-template-columns: repeat(3, 1fr);
                gap: 8px;
            }

            .overall-stat {
                padding: 12px;
            }

            .overall-stat-value {
                font-size: 1.25rem;
            }

            .summary-stats {
                gap: 16px;
            }

            .card {
                padding: 28px 20px;
            }

            .urdu-text {
                font-size: 1.35rem;
            }
        }

        /* Dark mode */
        @media (prefers-color-scheme: dark) {
            :root {
                --cream: #1a1a1a;
                --cream-dark: #252525;
                --ink: #e8e4df;
                --ink-light: #a8a4a0;
                --teal: #5a9a9a;
                --teal-deep: #6aacac;
                --amber: #d4a842;
                --amber-light: #e8c76b;
                --rose: #c87a7a;
                --rose-light: #a86a6a;
            }

            .nav, .card, .tense-card, .session-start, .session-summary,
            .overall-stat, .tense-progress {
                background: #222;
                border-color: rgba(255, 255, 255, 0.06);
            }

            .tense-formula, .example-pair, .session-stats-preview,
            .summary-stats, .session-phase {
                background: rgba(255, 255, 255, 0.05);
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="nav">
        <button class="nav-btn active" data-view="learn">Learn</button>
        <button class="nav-btn" data-view="practice">Practice</button>
        <button class="nav-btn" data-view="progress">Progress</button>
    </nav>

    <main class="main">
        <!-- ========== LEARN VIEW ========== -->
        <div id="learn-view" class="view active">
            <div class="learn-intro">
                <h1>Ø³ÛŒÚ©Ú¾ÛŒÚº</h1>
                <p>Learn each tense before practicing</p>
            </div>

            <div class="tense-cards" id="tense-cards">
                <!-- Generated by JS -->
            </div>
        </div>

        <!-- ========== PRACTICE VIEW ========== -->
        <div id="practice-view" class="view">
            <div class="practice-header">
                <h1>Practice</h1>
                <div class="session-info">
                    <span>ğŸ¯ <span id="accuracy-display">0%</span> accuracy</span>
                    <span>ğŸ”„ <span id="review-pile-count">0</span> to review</span>
                </div>
            </div>

            <div class="level-selector">
                <div class="level-selector-title">Select Level</div>
                <div class="levels" id="levels">
                    <!-- Generated by JS -->
                </div>
            </div>

            <div class="session-start" id="session-start">
                <h2>Ready to practice?</h2>
                <p>Practice makes perfect. Focus on understanding, not speed.</p>
                <div class="session-stats-preview">
                    <div class="stat-preview">
                        <div class="stat-preview-value" id="cards-to-practice">0</div>
                        <div class="stat-preview-label">Cards</div>
                    </div>
                    <div class="stat-preview">
                        <div class="stat-preview-value" id="review-cards">0</div>
                        <div class="stat-preview-label">Review</div>
                    </div>
                </div>
                <button class="btn-start-session" id="btn-start">Start Session</button>
            </div>

            <div class="card-container" id="card-container">
                <div class="session-phase" id="session-phase">Warm-up: Reviewing previous mistakes</div>

                <div class="card" id="card">
                    <div class="situation">
                        <div class="urdu-text" id="urdu"></div>
                    </div>
                    <div class="answer-section" id="answer-section">
                        <div class="english-answer" id="english"></div>
                        <div class="tense-label-container">
                            <span class="tense-label" id="tense-label"></span>
                        </div>
                        <div class="explanation" id="explanation"></div>
                        <div class="hide-hint">tap to hide</div>
                    </div>
                    <div class="tap-hint" id="tap-hint">tap to reveal</div>
                    <div class="buttons" id="buttons">
                        <button class="btn btn-wrong" id="btn-wrong">Review Again</button>
                        <button class="btn btn-right" id="btn-right">Got It</button>
                    </div>
                </div>

                <div class="progress-bar">
                    <div class="progress-fill" id="progress"></div>
                </div>
            </div>

            <div class="session-summary" id="session-summary">
                <h2>Session Complete!</h2>
                <p class="session-summary-subtitle">Great work! Here's how you did:</p>

                <div class="summary-stats">
                    <div class="summary-stat">
                        <div class="summary-stat-value" id="summary-correct">0</div>
                        <div class="summary-stat-label">Correct</div>
                    </div>
                    <div class="summary-stat">
                        <div class="summary-stat-value" id="summary-total">0</div>
                        <div class="summary-stat-label">Total</div>
                    </div>
                    <div class="summary-stat">
                        <div class="summary-stat-value" id="summary-accuracy">0%</div>
                        <div class="summary-stat-label">Accuracy</div>
                    </div>
                </div>

                <div class="weak-areas" id="weak-areas">
                    <div class="weak-areas-title">Focus Areas:</div>
                    <!-- Generated by JS -->
                </div>

                <div class="summary-buttons">
                    <button class="btn btn-secondary" id="btn-review-mistakes">Review Mistakes</button>
                    <button class="btn btn-right" id="btn-new-session">New Session</button>
                </div>
            </div>
        </div>

        <!-- ========== PROGRESS VIEW ========== -->
        <div id="progress-view" class="view">
            <div class="progress-header">
                <h1>Your Progress</h1>
                <p>Track your improvement over time</p>
            </div>

            <div class="overall-stats">
                <div class="overall-stat">
                    <div class="overall-stat-value" id="total-practiced">0</div>
                    <div class="overall-stat-label">Practiced</div>
                </div>
                <div class="overall-stat">
                    <div class="overall-stat-value" id="overall-accuracy">0%</div>
                    <div class="overall-stat-label">Accuracy</div>
                </div>
                <div class="overall-stat">
                    <div class="overall-stat-value" id="sessions-count">0</div>
                    <div class="overall-stat-label">Sessions</div>
                </div>
            </div>

            <div class="tense-progress">
                <div class="tense-progress-title">Accuracy by Tense</div>
                <div id="tense-progress-list">
                    <!-- Generated by JS -->
                </div>
            </div>

            <div class="reset-progress">
                <button class="btn-reset" id="btn-reset">Reset All Progress</button>
            </div>
        </div>
    </main>

    <script>
        // ========== TENSE EXPLANATIONS ==========
        const tenseExplanations = {
            'present-simple': {
                name: 'Present Simple',
                urduName: 'Ø­Ø§Ù„ Ù…Ø·Ù„Ù‚',
                formula: 'Subject + verb (s/es for he/she/it)',
                explanation: 'ÛŒÛ tense Ø¹Ø§Ø¯Ø§ØªØŒ Ø±ÙˆØ²Ù…Ø±Û Ú©Û’ Ú©Ø§Ù…ØŒ Ø§ÙˆØ± ÛÙ…ÛŒØ´Û Ø³Ú†ÛŒ Ø¨Ø§ØªÙˆÚº Ú©Û’ Ù„ÛŒÛ’ Ø§Ø³ØªØ¹Ù…Ø§Ù„ ÛÙˆØªØ§ ÛÛ’Û” Ø¬Ø¨ Ú©ÙˆØ¦ÛŒ Ú©Ø§Ù… Ø¨Ø§Ø± Ø¨Ø§Ø± ÛÙˆØªØ§ ÛÛ’ ÛŒØ§ Ú©ÙˆØ¦ÛŒ Ú†ÛŒØ² ÛÙ…ÛŒØ´Û Ø³Ú† ÛÛ’ØŒ ØªÙˆ ÛÙ… present simple Ø§Ø³ØªØ¹Ù…Ø§Ù„ Ú©Ø±ØªÛ’ ÛÛŒÚºÛ”',
                whenToUse: [
                    'Ø±ÙˆØ²Ø§Ù†Û Ú©ÛŒ Ø¹Ø§Ø¯Ø§Øª Ú©Û’ Ù„ÛŒÛ’ (Ù…ÛŒÚº Ø±ÙˆØ² Ú†Ø§Ø¦Û’ Ù¾ÛŒØªÛŒ ÛÙˆÚº)',
                    'ÛÙ…ÛŒØ´Û Ø³Ú†ÛŒ Ø¨Ø§ØªÙˆÚº Ú©Û’ Ù„ÛŒÛ’ (Ø³ÙˆØ±Ø¬ Ù…Ø´Ø±Ù‚ Ø³Û’ Ù†Ú©Ù„ØªØ§ ÛÛ’)',
                    'Ø´ÛŒÚˆÙˆÙ„ Ú©Û’ Ù„ÛŒÛ’ (Ù¹Ø±ÛŒÙ† 5 Ø¨Ø¬Û’ Ø¢ØªÛŒ ÛÛ’)'
                ],
                examples: [
                    { urdu: 'Ù…ÛŒÚº Ø±ÙˆØ²Ø§Ù†Û Ú©Ú¾Ø§Ù†Ø§ Ù¾Ú©Ø§ØªÛŒ ÛÙˆÚº', english: 'I cook every day.' },
                    { urdu: 'ÙˆÛ ÛØ± Ø´Ø§Ù… Ù¹ÛŒ ÙˆÛŒ Ø¯ÛŒÚ©Ú¾ØªØ§ ÛÛ’', english: 'He watches TV every evening.' },
                    { urdu: 'Ø¨Ú†Û’ ÛØ± Ø±ÙˆØ² Ø¨Ø§ÛØ± Ú©Ú¾ÛŒÙ„ØªÛ’ ÛÛŒÚº', english: 'The children play outside every day.' }
                ]
            },
            'present-continuous': {
                name: 'Present Continuous',
                urduName: 'Ø­Ø§Ù„ Ø¬Ø§Ø±ÛŒ',
                formula: 'Subject + am/is/are + verb-ing',
                explanation: 'ÛŒÛ tense Ø§Ø³ ÙˆÙ‚Øª Ø§Ø³ØªØ¹Ù…Ø§Ù„ ÛÙˆØªØ§ ÛÛ’ Ø¬Ø¨ Ú©ÙˆØ¦ÛŒ Ú©Ø§Ù… Ø§Ø¨Ú¾ÛŒ Ø§Ø³ÛŒ ÙˆÙ‚Øª ÛÙˆ Ø±ÛØ§ ÛÙˆÛ” Ø§Ú¯Ø± Ø¢Ù¾ Ú©Ø³ÛŒ Ø³Û’ Ù¾ÙˆÚ†Ú¾ÛŒÚº "ØªÙ… Ú©ÛŒØ§ Ú©Ø± Ø±ÛÛŒ ÛÙˆØŸ" ØªÙˆ Ø¬ÙˆØ§Ø¨ present continuous Ù…ÛŒÚº ÛÙˆÚ¯Ø§Û”',
                whenToUse: [
                    'Ø¬Ø¨ Ú©Ø§Ù… Ø§Ø¨Ú¾ÛŒ ÛÙˆ Ø±ÛØ§ ÛÙˆ (Ù…ÛŒÚº Ø§Ø¨Ú¾ÛŒ Ú©Ú¾Ø§Ù†Ø§ Ø¨Ù†Ø§ Ø±ÛÛŒ ÛÙˆÚº)',
                    'Ø¹Ø§Ø±Ø¶ÛŒ Ø­Ø§Ù„Ø§Øª Ú©Û’ Ù„ÛŒÛ’ (ÙˆÛ Ø¢Ø¬ Ú©Ù„ Ù„Ø§ÛÙˆØ± Ù…ÛŒÚº Ø±Û Ø±ÛÛ’ ÛÛŒÚº)',
                    'Ù…Ø³ØªÙ‚Ø¨Ù„ Ú©Û’ Ù¾Ú©Û’ Ù¾Ø±ÙˆÚ¯Ø±Ø§Ù… Ú©Û’ Ù„ÛŒÛ’ (ÛÙ… Ú©Ù„ Ø¬Ø§ Ø±ÛÛ’ ÛÛŒÚº)'
                ],
                examples: [
                    { urdu: 'Ù…ÛŒÚº Ø§Ø¨Ú¾ÛŒ Ú©Ú¾Ø§Ù†Ø§ Ù¾Ú©Ø§ Ø±ÛÛŒ ÛÙˆÚº', english: 'I am cooking right now.' },
                    { urdu: 'Ø¨Ú†Û’ Ø¨Ø§ÛØ± Ú©Ú¾ÛŒÙ„ Ø±ÛÛ’ ÛÛŒÚº', english: 'The children are playing outside.' },
                    { urdu: 'ÙˆÛ Ø§Ø¨Ú¾ÛŒ Ù¹ÛŒ ÙˆÛŒ Ø¯ÛŒÚ©Ú¾ Ø±ÛØ§ ÛÛ’', english: 'He is watching TV right now.' }
                ]
            },
            'past-simple': {
                name: 'Past Simple',
                urduName: 'Ù…Ø§Ø¶ÛŒ Ù…Ø·Ù„Ù‚',
                formula: 'Subject + verb (past form)',
                explanation: 'ÛŒÛ tense Ø§Ù† Ú©Ø§Ù…ÙˆÚº Ú©Û’ Ù„ÛŒÛ’ Ø§Ø³ØªØ¹Ù…Ø§Ù„ ÛÙˆØªØ§ ÛÛ’ Ø¬Ùˆ Ù…Ø§Ø¶ÛŒ Ù…ÛŒÚº Ø®ØªÙ… ÛÙˆ Ú†Ú©Û’ ÛÛŒÚºÛ” Ø¬Ø¨ Ø¢Ù¾ Ú©ÛØªÛ’ ÛÛŒÚº "Ú©Ù„"ØŒ "Ù¾Ú†Ú¾Ù„Û’ ÛÙØªÛ’"ØŒ "2020 Ù…ÛŒÚº" - ÛŒÛ Ø³Ø¨ past simple ÛÛ’ Ú©ÛŒÙˆÙ†Ú©Û ÙˆÙ‚Øª Ù…Ø®ØµÙˆØµ ÛÛ’ Ø§ÙˆØ± Ú©Ø§Ù… Ø®ØªÙ… ÛÙˆ Ú†Ú©Ø§ ÛÛ’Û”',
                whenToUse: [
                    'Ù…Ø§Ø¶ÛŒ Ú©Û’ Ø®ØªÙ… Ø´Ø¯Û Ú©Ø§Ù… (Ù…ÛŒÚº Ù†Û’ Ú©Ù„ ÙÙ„Ù… Ø¯ÛŒÚ©Ú¾ÛŒ)',
                    'Ù…Ø®ØµÙˆØµ ÙˆÙ‚Øª Ú©Û’ Ø³Ø§ØªÚ¾ (ÙˆÛ Ù¾Ú†Ú¾Ù„Û’ Ø³Ø§Ù„ Ù¾Ø§Ú©Ø³ØªØ§Ù† Ú¯Ø¦Û’)',
                    'Ú©ÛØ§Ù†ÛŒØ§Úº Ø³Ù†Ø§Ù†Û’ Ú©Û’ Ù„ÛŒÛ’ (ÙˆÛ Ø¢Ø¦ÛŒ Ø§ÙˆØ± Ø¨ÛŒÙ¹Ú¾ Ú¯Ø¦ÛŒ)'
                ],
                examples: [
                    { urdu: 'Ù…ÛŒÚº Ù†Û’ Ú©Ù„ ÛŒÛ ÙÙ„Ù… Ø¯ÛŒÚ©Ú¾ÛŒ', english: 'I watched this movie yesterday.' },
                    { urdu: 'ÙˆÛ Ù¾Ú†Ú¾Ù„Û’ Ø³Ø§Ù„ Ù¾Ø§Ú©Ø³ØªØ§Ù† Ú¯Ø¦Û’', english: 'They went to Pakistan last year.' },
                    { urdu: 'Ú©ÛŒØ§ ØªÙ… Ù†Û’ Ú©Ù„ Ù†Ø§Ø´ØªÛ Ú©ÛŒØ§ØŸ', english: 'Did you have breakfast yesterday?' }
                ]
            },
            'present-perfect': {
                name: 'Present Perfect',
                urduName: 'Ø­Ø§Ù„ ØªØ§Ù…',
                formula: 'Subject + have/has + past participle (verb 3)',
                explanation: 'ÛŒÛ Ø³Ø¨ Ø³Û’ Ù…Ø´Ú©Ù„ tense ÛÛ’! ÛŒÛ Ø§Ù† Ú©Ø§Ù…ÙˆÚº Ú©Û’ Ù„ÛŒÛ’ Ø§Ø³ØªØ¹Ù…Ø§Ù„ ÛÙˆØªØ§ ÛÛ’ Ø¬Ùˆ Ù…Ø§Ø¶ÛŒ Ù…ÛŒÚº ÛÙˆØ¦Û’ Ù„ÛŒÚ©Ù† Ø§Ù† Ú©Ø§ Ø§Ø«Ø± Ø§Ø¨Ú¾ÛŒ ØªÚ© ÛÛ’ØŒ ÛŒØ§ Ø¬Ø¨ ÛÙ… ÙˆÙ‚Øª Ù†ÛÛŒÚº Ø¨ØªØ§ØªÛ’Û” "Ù…ÛŒÚº Ù†Û’ ÙÙˆÙ† Ú©Ú¾Ùˆ Ø¯ÛŒØ§ ÛÛ’" - ÛŒØ¹Ù†ÛŒ Ø§Ø¨Ú¾ÛŒ Ø¨Ú¾ÛŒ Ù†ÛÛŒÚº Ù…Ù„Ø§Û” "Ù…ÛŒÚº Ù†Û’ ÛŒÛ ÙÙ„Ù… Ø¯ÛŒÚ©Ú¾ÛŒ ÛÛ’" - Ú©Ø¨Ú¾ÛŒØŒ ÙˆÙ‚Øª Ù†ÛÛŒÚº Ø¨ØªØ§ÛŒØ§Û”',
                whenToUse: [
                    'Ø¬Ø¨ Ù†ØªÛŒØ¬Û Ø§Ø¨Ú¾ÛŒ Ø§ÛÙ… ÛÙˆ (Ù…ÛŒÚº Ù†Û’ Ú†Ø§Ø¨ÛŒ Ú©Ú¾Ùˆ Ø¯ÛŒ ÛÛ’ - Ø§Ø¨Ú¾ÛŒ Ø¨Ú¾ÛŒ Ù†ÛÛŒÚº Ù…Ù„ÛŒ)',
                    'Ø²Ù†Ø¯Ú¯ÛŒ Ú©Û’ ØªØ¬Ø±Ø¨Ø§Øª (Ú©ÛŒØ§ ØªÙ… Ù†Û’ Ú©Ø¨Ú¾ÛŒ Ø³Ø´ÛŒ Ú©Ú¾Ø§Ø¦ÛŒ ÛÛ’ØŸ)',
                    'Ø§Ø¨Ú¾ÛŒ ØªÚ© Ø¬Ø§Ø±ÛŒ ÙˆÙ‚Øª (Ù…ÛŒÚº Ù†Û’ Ø¢Ø¬ Ù†Ø§Ø´ØªÛ Ù†ÛÛŒÚº Ú©ÛŒØ§)',
                    'Ø§Ø¨Ú¾ÛŒ Ø§Ø¨Ú¾ÛŒ ÛÙˆÙ†Û’ ÙˆØ§Ù„Û’ Ú©Ø§Ù… (Ù…ÛŒÚº Ù†Û’ Ø§Ø¨Ú¾ÛŒ Ú©Ú¾Ø§Ù†Ø§ Ø®ØªÙ… Ú©ÛŒØ§ ÛÛ’)'
                ],
                examples: [
                    { urdu: 'Ù…ÛŒÚº Ù†Û’ Ø§Ù¾Ù†Ø§ ÙÙˆÙ† Ú©Ú¾Ùˆ Ø¯ÛŒØ§ ÛÛ’', english: 'I have lost my phone.' },
                    { urdu: 'Ú©ÛŒØ§ ØªÙ… Ù†Û’ Ù†Ø§Ø´ØªÛ Ú©ÛŒØ§ ÛÛ’ØŸ', english: 'Have you had breakfast?' },
                    { urdu: 'Ù…ÛŒÚº Ù†Û’ ÛŒÛ ÙÙ„Ù… Ø¯ÛŒÚ©Ú¾ÛŒ ÛÛ’', english: 'I have seen this movie.' },
                    { urdu: 'ÙˆÛ Ù¾Ø§Ú©Ø³ØªØ§Ù† Ú¯Ø¦Û’ ÛÛŒÚº', english: 'They have gone to Pakistan.' }
                ]
            },
            'present-perfect-continuous': {
                name: 'Present Perfect Continuous',
                urduName: 'Ø­Ø§Ù„ ØªØ§Ù… Ø¬Ø§Ø±ÛŒ',
                formula: 'Subject + have/has + been + verb-ing',
                explanation: 'ÛŒÛ tense Ø§Ø³ ÙˆÙ‚Øª Ø§Ø³ØªØ¹Ù…Ø§Ù„ ÛÙˆØªØ§ ÛÛ’ Ø¬Ø¨ Ú©ÙˆØ¦ÛŒ Ú©Ø§Ù… Ù…Ø§Ø¶ÛŒ Ù…ÛŒÚº Ø´Ø±ÙˆØ¹ ÛÙˆØ§ Ø§ÙˆØ± Ø§Ø¨Ú¾ÛŒ ØªÚ© Ø¬Ø§Ø±ÛŒ ÛÛ’Û” "Ø³Û’" Ú©Ø§ Ø§Ø³ØªØ¹Ù…Ø§Ù„ ÛÙˆØªØ§ ÛÛ’ - "Ù…ÛŒÚº Ø¯Ùˆ Ú¯Ú¾Ù†Ù¹Û’ Ø³Û’ Ù¾Ú‘Ú¾ Ø±ÛÛŒ ÛÙˆÚº" ÛŒØ¹Ù†ÛŒ Ø¯Ùˆ Ú¯Ú¾Ù†Ù¹Û’ Ù¾ÛÙ„Û’ Ø´Ø±ÙˆØ¹ Ú©ÛŒØ§ Ø§ÙˆØ± Ø§Ø¨Ú¾ÛŒ Ø¨Ú¾ÛŒ Ù¾Ú‘Ú¾ Ø±ÛÛŒ ÛÙˆÚºÛ”',
                whenToUse: [
                    'Ø¬Ø¨ Ú©Ø§Ù… Ù…Ø§Ø¶ÛŒ Ø³Û’ Ø§Ø¨Ú¾ÛŒ ØªÚ© Ø¬Ø§Ø±ÛŒ ÛÙˆ (Ù…ÛŒÚº ØµØ¨Ø­ Ø³Û’ Ú©Ø§Ù… Ú©Ø± Ø±ÛÛŒ ÛÙˆÚº)',
                    'Ø¬Ø¨ Ù…Ø¯Øª Ø¨ØªØ§Ù†ÛŒ ÛÙˆ (ÙˆÛ ØªÛŒÙ† Ø³Ø§Ù„ Ø³Û’ ÛŒÛØ§Úº Ø±Û Ø±ÛÛ’ ÛÛŒÚº)'
                ],
                examples: [
                    { urdu: 'Ù…ÛŒÚº Ø¯Ùˆ Ú¯Ú¾Ù†Ù¹Û’ Ø³Û’ Ù¾Ú‘Ú¾ Ø±ÛÛŒ ÛÙˆÚº', english: 'I have been studying for two hours.' },
                    { urdu: 'Ø¨Ø§Ø±Ø´ ØµØ¨Ø­ Ø³Û’ ÛÙˆ Ø±ÛÛŒ ÛÛ’', english: 'It has been raining since morning.' },
                    { urdu: 'ÙˆÛ ØªÛŒÙ† Ø³Ø§Ù„ Ø³Û’ ÛŒÛØ§Úº Ú©Ø§Ù… Ú©Ø± Ø±ÛÛŒ ÛÛ’', english: 'She has been working here for three years.' }
                ]
            },
            'past-continuous': {
                name: 'Past Continuous',
                urduName: 'Ù…Ø§Ø¶ÛŒ Ø¬Ø§Ø±ÛŒ',
                formula: 'Subject + was/were + verb-ing',
                explanation: 'ÛŒÛ tense Ø§Ø³ ÙˆÙ‚Øª Ø§Ø³ØªØ¹Ù…Ø§Ù„ ÛÙˆØªØ§ ÛÛ’ Ø¬Ø¨ Ù…Ø§Ø¶ÛŒ Ù…ÛŒÚº Ú©ÙˆØ¦ÛŒ Ú©Ø§Ù… Ø¬Ø§Ø±ÛŒ ØªÚ¾Ø§Û” Ø®Ø§Øµ Ø·ÙˆØ± Ù¾Ø± Ø¬Ø¨ Ø§ÛŒÚ© Ú©Ø§Ù… ÛÙˆ Ø±ÛØ§ ØªÚ¾Ø§ Ø§ÙˆØ± Ø¯ÙˆØ³Ø±Ø§ Ú©Ø§Ù… ÛÙˆ Ú¯ÛŒØ§Û” "Ø¬Ø¨ ÙˆÛ Ø¢Ø¦ÛŒ Ù…ÛŒÚº Ú©Ú¾Ø§Ù†Ø§ Ø¨Ù†Ø§ Ø±ÛÛŒ ØªÚ¾ÛŒ" - Ú©Ú¾Ø§Ù†Ø§ Ø¨Ù†Ø§Ù†Ø§ Ø¬Ø§Ø±ÛŒ ØªÚ¾Ø§ØŒ Ø¢Ù†Ø§ ÛÙˆ Ú¯ÛŒØ§Û”',
                whenToUse: [
                    'Ø¬Ø¨ Ù…Ø§Ø¶ÛŒ Ù…ÛŒÚº Ú©Ø§Ù… Ø¬Ø§Ø±ÛŒ ØªÚ¾Ø§ (Ú©Ù„ Ø±Ø§Øª 8 Ø¨Ø¬Û’ Ù…ÛŒÚº Ù¾Ú‘Ú¾ Ø±ÛÛŒ ØªÚ¾ÛŒ)',
                    'Ø¬Ø¨ Ø§ÛŒÚ© Ú©Ø§Ù… Ø¬Ø§Ø±ÛŒ ØªÚ¾Ø§ Ø§ÙˆØ± Ø¯ÙˆØ³Ø±Ø§ ÛÙˆØ§ (Ø¬Ø¨ ÙÙˆÙ† Ø¢ÛŒØ§ Ù…ÛŒÚº Ø³Ùˆ Ø±ÛÛŒ ØªÚ¾ÛŒ)'
                ],
                examples: [
                    { urdu: 'Ø¬Ø¨ ÙˆÛ Ø¢Ø¦ÛŒ Ù…ÛŒÚº Ú©Ú¾Ø§Ù†Ø§ Ù¾Ú©Ø§ Ø±ÛÛŒ ØªÚ¾ÛŒ', english: 'I was cooking when she arrived.' },
                    { urdu: 'Ú©Ù„ Ø±Ø§Øª Ø¢Ù¹Ú¾ Ø¨Ø¬Û’ Ù…ÛŒÚº Ù¾Ú‘Ú¾ Ø±ÛÛŒ ØªÚ¾ÛŒ', english: 'I was studying at 8 PM last night.' },
                    { urdu: 'Ø¬Ø¨ ÙÙˆÙ† Ø¢ÛŒØ§ Ø¨Ú†Û’ Ø³Ùˆ Ø±ÛÛ’ ØªÚ¾Û’', english: 'The children were sleeping when the phone rang.' }
                ]
            },
            'future': {
                name: 'Future Tenses',
                urduName: 'Ù…Ø³ØªÙ‚Ø¨Ù„',
                formula: 'will + verb OR am/is/are + going to + verb',
                explanation: 'Ù…Ø³ØªÙ‚Ø¨Ù„ Ú©Û’ Ù„ÛŒÛ’ Ø¯Ùˆ Ø·Ø±ÛŒÙ‚Û’ ÛÛŒÚº: "will" ÙÙˆØ±ÛŒ ÙÛŒØµÙ„ÙˆÚº Ø§ÙˆØ± ÙˆØ¹Ø¯ÙˆÚº Ú©Û’ Ù„ÛŒÛ’ØŒ "going to" Ù¾ÛÙ„Û’ Ø³Û’ Ø¨Ù†Û’ Ù¾Ù„Ø§Ù† Ú©Û’ Ù„ÛŒÛ’Û” "Ù…ÛŒÚº Ú†Ø§Ø¦Û’ Ø¨Ù†Ø§Ø¤Úº Ú¯ÛŒ" (Ø§Ø¨Ú¾ÛŒ ÙÛŒØµÙ„Û Ú©ÛŒØ§) Ø¨Ù…Ù‚Ø§Ø¨Ù„Û "Ù…ÛŒÚº Ú©Ù„ ÚˆØ§Ú©Ù¹Ø± Ú©Û’ Ù¾Ø§Ø³ Ø¬Ø§Ù†Û’ ÙˆØ§Ù„ÛŒ ÛÙˆÚº" (Ù¾ÛÙ„Û’ Ø³Û’ Ù¾Ù„Ø§Ù† ÛÛ’)Û”',
                whenToUse: [
                    'will: ÙÙˆØ±ÛŒ ÙÛŒØµÙ„Û’ (Ù¹Ú¾ÛŒÚ© ÛÛ’ØŒ Ù…ÛŒÚº Ù…Ø¯Ø¯ Ú©Ø±ÙˆÚº Ú¯ÛŒ)',
                    'will: ÙˆØ¹Ø¯Û’ (Ù…ÛŒÚº Ú©Ù„ Ø¶Ø±ÙˆØ± Ø¢Ø¤Úº Ú¯ÛŒ)',
                    'going to: Ù¾ÛÙ„Û’ Ø³Û’ Ù¾Ù„Ø§Ù† (Ù…ÛŒÚº Ú©Ù„ ÚˆØ§Ú©Ù¹Ø± Ú©Û’ Ù¾Ø§Ø³ Ø¬Ø§Ù†Û’ ÙˆØ§Ù„ÛŒ ÛÙˆÚº)',
                    'going to: Ù†Ø´Ø§Ù†ÛŒÙˆÚº Ø³Û’ Ù¾ÛŒØ´Ú¯ÙˆØ¦ÛŒ (Ø¨Ø§Ø¯Ù„ ÛÛŒÚºØŒ Ø¨Ø§Ø±Ø´ ÛÙˆÙ†Û’ ÙˆØ§Ù„ÛŒ ÛÛ’)'
                ],
                examples: [
                    { urdu: 'Ù…ÛŒÚº Ú†Ø§Ø¦Û’ Ø¨Ù†Ø§Ø¤Úº Ú¯ÛŒ', english: 'I will make some tea.' },
                    { urdu: 'Ù…ÛŒÚº Ú©Ù„ ÚˆØ§Ú©Ù¹Ø± Ú©Û’ Ù¾Ø§Ø³ Ø¬Ø§Ù†Û’ ÙˆØ§Ù„ÛŒ ÛÙˆÚº', english: 'I am going to see the doctor tomorrow.' },
                    { urdu: 'Ø¨Ø§Ø±Ø´ ÛÙˆÙ†Û’ ÙˆØ§Ù„ÛŒ ÛÛ’', english: 'It is going to rain.' },
                    { urdu: 'ÛÙ… Ø§Ú¯Ù„Û’ ÛÙØªÛ’ Ù„Ø§ÛÙˆØ± Ø¬Ø§ Ø±ÛÛ’ ÛÛŒÚº', english: 'We are going to Lahore next week.' }
                ]
            }
        };

        // ========== SITUATIONS ==========
        const situations = [
            // PRESENT PERFECT vs PAST SIMPLE
            { urdu: "Ù…ÛŒÚº Ù†Û’ Ø§Ø¨Ú¾ÛŒ Ø§Ø¨Ú¾ÛŒ Ú©Ú¾Ø§Ù†Ø§ Ø®ØªÙ… Ú©ÛŒØ§ ÛÛ’", english: "I have just finished eating.", tense: "Present Perfect", explanation: "Ø§Ø¨Ú¾ÛŒ Ø§Ø¨Ú¾ÛŒ ÛÙˆÙ†Û’ ÙˆØ§Ù„Û’ Ú©Ø§Ù… Ú©Û’ Ù„ÛŒÛ’ present perfect Ø§Ø³ØªØ¹Ù…Ø§Ù„ ÛÙˆØªØ§ ÛÛ’", category: "present-perfect" },
            { urdu: "Ù…ÛŒÚº Ù†Û’ Ú©Ù„ ÛŒÛ ÙÙ„Ù… Ø¯ÛŒÚ©Ú¾ÛŒ", english: "I watched this movie yesterday.", tense: "Past Simple", explanation: "Ú©Ù„ - Ù…Ø®ØµÙˆØµ ÙˆÙ‚Øª Ù…Ø§Ø¶ÛŒ Ù…ÛŒÚºØŒ Ø§Ø³ Ù„ÛŒÛ’ past simple", category: "past-simple" },
            { urdu: "Ù…ÛŒÚº Ù†Û’ ÛŒÛ ÙÙ„Ù… Ø¯ÛŒÚ©Ú¾ÛŒ ÛÛ’", english: "I have seen this movie.", tense: "Present Perfect", explanation: "Ø²Ù†Ø¯Ú¯ÛŒ Ù…ÛŒÚº Ú©Ø¨Ú¾ÛŒ - ÙˆÙ‚Øª Ù†ÛÛŒÚº Ø¨ØªØ§ÛŒØ§ØŒ ØªØ¬Ø±Ø¨Û Ø¨ØªØ§ÛŒØ§ØŒ present perfect", category: "present-perfect" },
            { urdu: "ÙˆÛ Ù¾Ø§Ú©Ø³ØªØ§Ù† Ú¯Ø¦Û’ ÛÛŒÚº", english: "They have gone to Pakistan.", tense: "Present Perfect", explanation: "Ø§Ø¨Ú¾ÛŒ ØªÚ© ÙˆÛØ§Úº ÛÛŒÚº - Ù†ØªÛŒØ¬Û Ø§Ø¨Ú¾ÛŒ Ù…ÙˆØ¬ÙˆØ¯ ÛÛ’ØŒ present perfect", category: "present-perfect" },
            { urdu: "ÙˆÛ Ù¾Ú†Ú¾Ù„Û’ Ø³Ø§Ù„ Ù¾Ø§Ú©Ø³ØªØ§Ù† Ú¯Ø¦Û’", english: "They went to Pakistan last year.", tense: "Past Simple", explanation: "Ù¾Ú†Ú¾Ù„Û’ Ø³Ø§Ù„ - Ù…Ø®ØµÙˆØµ ÙˆÙ‚Øª Ù…Ø§Ø¶ÛŒ Ù…ÛŒÚºØŒ past simple", category: "past-simple" },
            { urdu: "Ú©ÛŒØ§ ØªÙ… Ù†Û’ Ù†Ø§Ø´ØªÛ Ú©ÛŒØ§ ÛÛ’ØŸ", english: "Have you had breakfast?", tense: "Present Perfect", explanation: "Ø§Ø¨Ú¾ÛŒ Ù…ØªØ¹Ù„Ù‚ ÛÛ’ - Ú©ÛŒØ§ Ù†Ø§Ø´ØªÛ Ú©ÛŒØ§ ÛŒØ§ Ù†ÛÛŒÚºØŒ present perfect", category: "present-perfect" },
            { urdu: "Ú©ÛŒØ§ ØªÙ… Ù†Û’ Ú©Ù„ Ù†Ø§Ø´ØªÛ Ú©ÛŒØ§ØŸ", english: "Did you have breakfast yesterday?", tense: "Past Simple", explanation: "Ú©Ù„ Ú©Û’ Ø¨Ø§Ø±Û’ Ù…ÛŒÚº Ù¾ÙˆÚ†Ú¾ Ø±ÛÛŒ ÛÛŒÚº - Ù…Ø®ØµÙˆØµ ÙˆÙ‚ØªØŒ past simple", category: "past-simple" },
            { urdu: "Ù…ÛŒÚº Ù†Û’ Ø§Ù¾Ù†Ø§ ÙÙˆÙ† Ú©Ú¾Ùˆ Ø¯ÛŒØ§ ÛÛ’", english: "I have lost my phone.", tense: "Present Perfect", explanation: "Ø§Ø¨Ú¾ÛŒ Ø¨Ú¾ÛŒ Ù†ÛÛŒÚº Ù…Ù„Ø§ - Ù†ØªÛŒØ¬Û Ø§Ø¨Ú¾ÛŒ Ù…ÙˆØ¬ÙˆØ¯ ÛÛ’ØŒ present perfect", category: "present-perfect" },
            { urdu: "Ù…ÛŒÚº Ù†Û’ Ù¾Ú†Ú¾Ù„Û’ ÛÙØªÛ’ Ø§Ù¾Ù†Ø§ ÙÙˆÙ† Ú©Ú¾ÙˆÛŒØ§ Ù„ÛŒÚ©Ù† Ù…Ù„ Ú¯ÛŒØ§", english: "I lost my phone last week but I found it.", tense: "Past Simple", explanation: "Ø®ØªÙ… Ø´Ø¯Û ÙˆØ§Ù‚Ø¹Û Ù…Ø§Ø¶ÛŒ Ù…ÛŒÚºØŒ past simple", category: "past-simple" },
            { urdu: "Ù…ÛŒÚº Ù†Û’ Ø¢Ø¬ Ù†Ø§Ø´ØªÛ Ù†ÛÛŒÚº Ú©ÛŒØ§", english: "I haven't had breakfast today.", tense: "Present Perfect", explanation: "Ø¢Ø¬ Ø§Ø¨Ú¾ÛŒ Ø®ØªÙ… Ù†ÛÛŒÚº ÛÙˆØ§ - present perfect", category: "present-perfect" },
            { urdu: "Ù…ÛŒÚº Ù†Û’ Ø§Ø³ ÛÙØªÛ’ ØªÛŒÙ† ÙÙ„Ù…ÛŒÚº Ø¯ÛŒÚ©Ú¾ÛŒ ÛÛŒÚº", english: "I have watched three movies this week.", tense: "Present Perfect", explanation: "ÛŒÛ ÛÙØªÛ Ø§Ø¨Ú¾ÛŒ Ø¬Ø§Ø±ÛŒ ÛÛ’ - present perfect", category: "present-perfect" },
            { urdu: "Ù…ÛŒÚº Ù†Û’ Ù¾Ú†Ú¾Ù„Û’ ÛÙØªÛ’ ØªÛŒÙ† ÙÙ„Ù…ÛŒÚº Ø¯ÛŒÚ©Ú¾ÛŒÚº", english: "I watched three movies last week.", tense: "Past Simple", explanation: "Ù¾Ú†Ú¾Ù„Ø§ ÛÙØªÛ Ø®ØªÙ… ÛÙˆ Ú¯ÛŒØ§ - past simple", category: "past-simple" },
            { urdu: "Ú©ÛŒØ§ ØªÙ… Ù†Û’ Ú©Ø¨Ú¾ÛŒ Ø³Ø´ÛŒ Ú©Ú¾Ø§Ø¦ÛŒ ÛÛ’ØŸ", english: "Have you ever eaten sushi?", tense: "Present Perfect", explanation: "Ú©Ø¨Ú¾ÛŒ - Ø²Ù†Ø¯Ú¯ÛŒ Ú©Ø§ ØªØ¬Ø±Ø¨Û - present perfect", category: "present-perfect" },
            { urdu: "Ù…ÛŒÚº Ù†Û’ Ø¬Ø§Ù¾Ø§Ù† Ù…ÛŒÚº Ø³Ø´ÛŒ Ú©Ú¾Ø§Ø¦ÛŒ", english: "I ate sushi when I was in Japan.", tense: "Past Simple", explanation: "Ø¬Ø§Ù¾Ø§Ù† Ù…ÛŒÚº ØªÚ¾ÛŒ - Ù…Ø®ØµÙˆØµ ÙˆÙ‚Øª Ù…Ø§Ø¶ÛŒ Ù…ÛŒÚº - past simple", category: "past-simple" },

            // PRESENT CONTINUOUS vs PRESENT SIMPLE
            { urdu: "Ù…ÛŒÚº Ø§Ø¨Ú¾ÛŒ Ú©Ú¾Ø§Ù†Ø§ Ù¾Ú©Ø§ Ø±ÛÛŒ ÛÙˆÚº", english: "I am cooking right now.", tense: "Present Continuous", explanation: "Ø§Ø¨Ú¾ÛŒ Ø§Ø³ ÙˆÙ‚Øª ÛÙˆ Ø±ÛØ§ ÛÛ’ - present continuous", category: "present-continuous" },
            { urdu: "Ù…ÛŒÚº Ø±ÙˆØ²Ø§Ù†Û Ú©Ú¾Ø§Ù†Ø§ Ù¾Ú©Ø§ØªÛŒ ÛÙˆÚº", english: "I cook every day.", tense: "Present Simple", explanation: "Ø±ÙˆØ²Ø§Ù†Û Ú©Ø§ Ù…Ø¹Ù…ÙˆÙ„ - present simple", category: "present-simple" },
            { urdu: "Ø¨Ú†Û’ Ø¨Ø§ÛØ± Ú©Ú¾ÛŒÙ„ Ø±ÛÛ’ ÛÛŒÚº", english: "The children are playing outside.", tense: "Present Continuous", explanation: "Ø§Ø¨Ú¾ÛŒ ÛÙˆ Ø±ÛØ§ ÛÛ’ - present continuous", category: "present-continuous" },
            { urdu: "Ø¨Ú†Û’ ÛØ± Ø±ÙˆØ² Ø¨Ø§ÛØ± Ú©Ú¾ÛŒÙ„ØªÛ’ ÛÛŒÚº", english: "The children play outside every day.", tense: "Present Simple", explanation: "ÛØ± Ø±ÙˆØ² - Ø¹Ø§Ø¯ØªØŒ present simple", category: "present-simple" },
            { urdu: "ÙˆÛ Ø§Ø¨Ú¾ÛŒ Ù¹ÛŒ ÙˆÛŒ Ø¯ÛŒÚ©Ú¾ Ø±ÛØ§ ÛÛ’", english: "He is watching TV right now.", tense: "Present Continuous", explanation: "Ø§Ø¨Ú¾ÛŒ ÛÙˆ Ø±ÛØ§ ÛÛ’ØŒ present continuous", category: "present-continuous" },
            { urdu: "ÙˆÛ ÛØ± Ø´Ø§Ù… Ù¹ÛŒ ÙˆÛŒ Ø¯ÛŒÚ©Ú¾ØªØ§ ÛÛ’", english: "He watches TV every evening.", tense: "Present Simple", explanation: "ÛØ± Ø´Ø§Ù… - Ø¹Ø§Ø¯Øª/Ù…Ø¹Ù…ÙˆÙ„ØŒ present simple", category: "present-simple" },

            // PRESENT PERFECT CONTINUOUS
            { urdu: "Ù…ÛŒÚº Ø¯Ùˆ Ú¯Ú¾Ù†Ù¹Û’ Ø³Û’ Ù¾Ú‘Ú¾ Ø±ÛÛŒ ÛÙˆÚº", english: "I have been studying for two hours.", tense: "Present Perfect Continuous", explanation: "Ø¯Ùˆ Ú¯Ú¾Ù†Ù¹Û’ Ø³Û’ Ø¬Ø§Ø±ÛŒ ÛÛ’ Ø§ÙˆØ± Ø§Ø¨Ú¾ÛŒ Ø¨Ú¾ÛŒ ÛÙˆ Ø±ÛØ§ ÛÛ’ - present perfect continuous", category: "present-perfect-continuous" },
            { urdu: "Ø¨Ø§Ø±Ø´ ØµØ¨Ø­ Ø³Û’ ÛÙˆ Ø±ÛÛŒ ÛÛ’", english: "It has been raining since morning.", tense: "Present Perfect Continuous", explanation: "ØµØ¨Ø­ Ø³Û’ Ø´Ø±ÙˆØ¹ ÛÙˆØ¦ÛŒ Ø§ÙˆØ± Ø§Ø¨Ú¾ÛŒ ØªÚ© Ø¬Ø§Ø±ÛŒ ÛÛ’ - present perfect continuous", category: "present-perfect-continuous" },
            { urdu: "ÙˆÛ ØªÛŒÙ† Ø³Ø§Ù„ Ø³Û’ ÛŒÛØ§Úº Ú©Ø§Ù… Ú©Ø± Ø±ÛÛŒ ÛÛ’", english: "She has been working here for three years.", tense: "Present Perfect Continuous", explanation: "ØªÛŒÙ† Ø³Ø§Ù„ Ø³Û’ Ø¬Ø§Ø±ÛŒ ÛÛ’ - present perfect continuous", category: "present-perfect-continuous" },
            { urdu: "Ù…ÛŒÚº Ø¢Ø¯Ú¾Û’ Ú¯Ú¾Ù†Ù¹Û’ Ø³Û’ ØªÙ…ÛØ§Ø±Ø§ Ø§Ù†ØªØ¸Ø§Ø± Ú©Ø± Ø±ÛÛŒ ÛÙˆÚº", english: "I have been waiting for you for half an hour.", tense: "Present Perfect Continuous", explanation: "Ø¢Ø¯Ú¾Û’ Ú¯Ú¾Ù†Ù¹Û’ Ø³Û’ Ø§Ù†ØªØ¸Ø§Ø± Ø¬Ø§Ø±ÛŒ ÛÛ’ - present perfect continuous", category: "present-perfect-continuous" },

            // PAST CONTINUOUS
            { urdu: "Ø¬Ø¨ ÙˆÛ Ø¢Ø¦ÛŒ Ù…ÛŒÚº Ú©Ú¾Ø§Ù†Ø§ Ù¾Ú©Ø§ Ø±ÛÛŒ ØªÚ¾ÛŒ", english: "I was cooking when she arrived.", tense: "Past Continuous + Past Simple", explanation: "Ø§ÛŒÚ© Ú©Ø§Ù… Ø¬Ø§Ø±ÛŒ ØªÚ¾Ø§ (was cooking) Ø¬Ø¨ Ø¯ÙˆØ³Ø±Ø§ ÛÙˆØ§ (arrived)", category: "past-continuous" },
            { urdu: "Ú©Ù„ Ø±Ø§Øª Ø¢Ù¹Ú¾ Ø¨Ø¬Û’ Ù…ÛŒÚº Ù¾Ú‘Ú¾ Ø±ÛÛŒ ØªÚ¾ÛŒ", english: "I was studying at 8 PM last night.", tense: "Past Continuous", explanation: "Ù…Ø§Ø¶ÛŒ Ù…ÛŒÚº Ø§ÛŒÚ© Ø®Ø§Øµ ÙˆÙ‚Øª Ù¾Ø± Ú©Ø§Ù… Ø¬Ø§Ø±ÛŒ ØªÚ¾Ø§ - past continuous", category: "past-continuous" },
            { urdu: "Ø¬Ø¨ ÙÙˆÙ† Ø¢ÛŒØ§ Ø¨Ú†Û’ Ø³Ùˆ Ø±ÛÛ’ ØªÚ¾Û’", english: "The children were sleeping when the phone rang.", tense: "Past Continuous + Past Simple", explanation: "Ø³ÙˆÙ†Ø§ Ø¬Ø§Ø±ÛŒ ØªÚ¾Ø§ØŒ ÙÙˆÙ† Ú©ÛŒ Ú¯Ú¾Ù†Ù¹ÛŒ Ø¨Ø¬ÛŒ - past continuous + past simple", category: "past-continuous" },

            // FUTURE
            { urdu: "Ù…ÛŒÚº Ú†Ø§Ø¦Û’ Ø¨Ù†Ø§Ø¤Úº Ú¯ÛŒ", english: "I will make some tea.", tense: "Future Simple (will)", explanation: "Ø§Ø¨Ú¾ÛŒ ÙÛŒØµÙ„Û Ú©ÛŒØ§ - spontaneous decisionØŒ will Ø§Ø³ØªØ¹Ù…Ø§Ù„ ÛÙˆØªØ§ ÛÛ’", category: "future" },
            { urdu: "Ù…ÛŒÚº Ú©Ù„ ÚˆØ§Ú©Ù¹Ø± Ú©Û’ Ù¾Ø§Ø³ Ø¬Ø§Ù†Û’ ÙˆØ§Ù„ÛŒ ÛÙˆÚº", english: "I am going to see the doctor tomorrow.", tense: "Future (going to)", explanation: "Ù¾ÛÙ„Û’ Ø³Û’ Ù¾Ù„Ø§Ù† ÛÛ’ - going to Ø§Ø³ØªØ¹Ù…Ø§Ù„ ÛÙˆØªØ§ ÛÛ’", category: "future" },
            { urdu: "Ø¨Ø§Ø±Ø´ ÛÙˆÙ†Û’ ÙˆØ§Ù„ÛŒ ÛÛ’", english: "It is going to rain.", tense: "Future (going to)", explanation: "Ù†Ø´Ø§Ù†ÛŒØ§Úº Ù…ÙˆØ¬ÙˆØ¯ ÛÛŒÚº - going to", category: "future" },
            { urdu: "Ù…ÛŒÚº Ú©Ù„ Ø¶Ø±ÙˆØ± Ø¢Ø¤Úº Ú¯ÛŒ", english: "I will definitely come tomorrow.", tense: "Future Simple (will)", explanation: "ÙˆØ¹Ø¯Û Ú©Ø±Ù†Ø§ - will Ø§Ø³ØªØ¹Ù…Ø§Ù„ ÛÙˆØªØ§ ÛÛ’", category: "future" },
            { urdu: "ÛÙ… Ø§Ú¯Ù„Û’ ÛÙØªÛ’ Ù„Ø§ÛÙˆØ± Ø¬Ø§ Ø±ÛÛ’ ÛÛŒÚº", english: "We are going to Lahore next week.", tense: "Present Continuous (for future)", explanation: "Ù¾Ú©Ø§ Ù¾Ø±ÙˆÚ¯Ø±Ø§Ù… - present continuous Ø¨Ú¾ÛŒ future Ú©Û’ Ù„ÛŒÛ’ Ø§Ø³ØªØ¹Ù…Ø§Ù„ ÛÙˆØªØ§ ÛÛ’", category: "future" },
        ];

        // ========== LEVELS ==========
        const levels = [
            { id: 'basics', name: 'Basics', categories: ['present-simple', 'present-continuous'], unlocked: true },
            { id: 'past', name: 'Past', categories: ['past-simple', 'past-continuous'], unlocked: true },
            { id: 'perfect', name: 'Present Perfect', categories: ['present-perfect'], unlocked: true },
            { id: 'perfect-challenge', name: 'Perfect vs Simple', categories: ['present-perfect', 'past-simple'], unlocked: true },
            { id: 'continuous', name: 'Continuous', categories: ['present-perfect-continuous', 'past-continuous'], unlocked: true },
            { id: 'future', name: 'Future', categories: ['future'], unlocked: true },
            { id: 'all', name: 'All Mixed', categories: ['all'], unlocked: true },
        ];

        // ========== STATE ==========
        let state = {
            currentView: 'learn',
            currentLevel: 'basics',
            sessionActive: false,
            currentSituations: [],
            currentIndex: 0,
            reviewPile: [],
            sessionCorrect: 0,
            sessionTotal: 0,
            sessionPhase: 'warmup', // warmup, main, review
            revealed: false,
            stats: loadStats()
        };

        // ========== LOCAL STORAGE ==========
        function loadStats() {
            const saved = localStorage.getItem('tenseStats');
            if (saved) {
                return JSON.parse(saved);
            }
            return {
                totalPracticed: 0,
                totalCorrect: 0,
                sessionsCompleted: 0,
                byCategory: {},
                reviewQueue: []
            };
        }

        function saveStats() {
            localStorage.setItem('tenseStats', JSON.stringify(state.stats));
        }

        function updateCategoryStats(category, correct) {
            if (!state.stats.byCategory[category]) {
                state.stats.byCategory[category] = { practiced: 0, correct: 0 };
            }
            state.stats.byCategory[category].practiced++;
            if (correct) {
                state.stats.byCategory[category].correct++;
            }
            state.stats.totalPracticed++;
            if (correct) {
                state.stats.totalCorrect++;
            }
            saveStats();
        }

        function addToReviewQueue(situation) {
            // Add with spaced repetition weight
            const existing = state.stats.reviewQueue.find(r => r.urdu === situation.urdu);
            if (existing) {
                existing.weight = Math.min(existing.weight + 1, 5);
            } else {
                state.stats.reviewQueue.push({
                    ...situation,
                    weight: 1,
                    addedAt: Date.now()
                });
            }
            // Keep queue manageable
            if (state.stats.reviewQueue.length > 50) {
                state.stats.reviewQueue = state.stats.reviewQueue.slice(-50);
            }
            saveStats();
        }

        function removeFromReviewQueue(situation) {
            state.stats.reviewQueue = state.stats.reviewQueue.filter(r => r.urdu !== situation.urdu);
            saveStats();
        }

        // ========== DOM ELEMENTS ==========
        const navBtns = document.querySelectorAll('.nav-btn');
        const views = document.querySelectorAll('.view');
        const tenseCardsContainer = document.getElementById('tense-cards');
        const levelsContainer = document.getElementById('levels');
        const sessionStart = document.getElementById('session-start');
        const cardContainer = document.getElementById('card-container');
        const sessionSummary = document.getElementById('session-summary');
        const card = document.getElementById('card');
        const urduEl = document.getElementById('urdu');
        const englishEl = document.getElementById('english');
        const tenseLabelEl = document.getElementById('tense-label');
        const explanationEl = document.getElementById('explanation');
        const answerSection = document.getElementById('answer-section');
        const tapHint = document.getElementById('tap-hint');
        const buttons = document.getElementById('buttons');
        const btnWrong = document.getElementById('btn-wrong');
        const btnRight = document.getElementById('btn-right');
        const progressEl = document.getElementById('progress');
        const sessionPhaseEl = document.getElementById('session-phase');

        // ========== NAVIGATION ==========
        navBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const view = btn.dataset.view;
                switchView(view);
            });
        });

        function switchView(viewName) {
            state.currentView = viewName;
            navBtns.forEach(btn => {
                btn.classList.toggle('active', btn.dataset.view === viewName);
            });
            views.forEach(view => {
                view.classList.toggle('active', view.id === `${viewName}-view`);
            });

            if (viewName === 'progress') {
                updateProgressView();
            } else if (viewName === 'practice') {
                updatePracticeView();
            }
        }

        // ========== LEARN VIEW ==========
        function renderLearnView() {
            tenseCardsContainer.innerHTML = '';

            Object.entries(tenseExplanations).forEach(([key, tense]) => {
                const card = document.createElement('div');
                card.className = 'tense-card';
                card.innerHTML = `
                    <div class="tense-card-header">
                        <div>
                            <div class="tense-card-title">${tense.name}</div>
                            <div class="tense-card-urdu">${tense.urduName}</div>
                        </div>
                        <div class="tense-card-toggle">â–¼</div>
                    </div>
                    <div class="tense-card-content">
                        <div class="tense-card-body">
                            <div class="tense-formula">${tense.formula}</div>
                            <div class="tense-explanation">${tense.explanation}</div>
                            <div class="tense-when">
                                <div class="tense-when-title">Ú©Ø¨ Ø§Ø³ØªØ¹Ù…Ø§Ù„ Ú©Ø±ÛŒÚº:</div>
                                <ul class="tense-when-list">
                                    ${tense.whenToUse.map(w => `<li>${w}</li>`).join('')}
                                </ul>
                            </div>
                            <div class="tense-examples">
                                <div class="tense-examples-title">Examples:</div>
                                ${tense.examples.map(ex => `
                                    <div class="example-pair">
                                        <div class="example-urdu">${ex.urdu}</div>
                                        <div class="example-english">${ex.english}</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;

                card.querySelector('.tense-card-header').addEventListener('click', () => {
                    card.classList.toggle('open');
                });

                tenseCardsContainer.appendChild(card);
            });
        }

        // ========== PRACTICE VIEW ==========
        function renderLevels() {
            levelsContainer.innerHTML = '';
            levels.forEach(level => {
                const btn = document.createElement('button');
                btn.className = `level-btn ${state.currentLevel === level.id ? 'active' : ''} ${!level.unlocked ? 'locked' : ''}`;
                btn.textContent = level.name;
                btn.disabled = !level.unlocked;
                btn.addEventListener('click', () => selectLevel(level.id));
                levelsContainer.appendChild(btn);
            });
        }

        function selectLevel(levelId) {
            state.currentLevel = levelId;
            renderLevels();
            updatePracticeView();
        }

        function updatePracticeView() {
            const level = levels.find(l => l.id === state.currentLevel);
            const levelSituations = level.categories.includes('all')
                ? situations
                : situations.filter(s => level.categories.includes(s.category));

            const reviewCount = state.stats.reviewQueue.length;

            document.getElementById('cards-to-practice').textContent = levelSituations.length;
            document.getElementById('review-cards').textContent = reviewCount;
            document.getElementById('review-pile-count').textContent = reviewCount;

            const totalPracticed = state.stats.totalPracticed;
            const accuracy = totalPracticed > 0
                ? Math.round((state.stats.totalCorrect / totalPracticed) * 100)
                : 0;
            document.getElementById('accuracy-display').textContent = accuracy + '%';
        }

        function startSession() {
            const level = levels.find(l => l.id === state.currentLevel);
            let levelSituations = level.categories.includes('all')
                ? [...situations]
                : situations.filter(s => level.categories.includes(s.category));

            // Shuffle
            levelSituations = shuffle(levelSituations);

            // Build session: warmup (review) + main
            const reviewCards = state.stats.reviewQueue.slice(0, 5);

            state.sessionActive = true;
            state.currentIndex = 0;
            state.sessionCorrect = 0;
            state.sessionTotal = 0;
            state.reviewPile = [];
            state.revealed = false;

            if (reviewCards.length > 0) {
                state.sessionPhase = 'warmup';
                state.currentSituations = [...reviewCards, ...levelSituations.slice(0, 15)];
                state.warmupCount = reviewCards.length;
            } else {
                state.sessionPhase = 'main';
                state.currentSituations = levelSituations.slice(0, 20);
                state.warmupCount = 0;
            }

            sessionStart.style.display = 'none';
            cardContainer.classList.add('active');
            sessionSummary.classList.remove('active');

            updateSessionPhaseDisplay();
            displayCard();
        }

        function updateSessionPhaseDisplay() {
            if (state.sessionPhase === 'warmup') {
                sessionPhaseEl.textContent = 'ğŸ”„ Warm-up: Reviewing previous mistakes';
                sessionPhaseEl.style.display = 'block';
            } else if (state.sessionPhase === 'review') {
                sessionPhaseEl.textContent = 'ğŸ”„ Review: Cards you marked for review';
                sessionPhaseEl.style.display = 'block';
            } else {
                sessionPhaseEl.style.display = 'none';
            }
        }

        function displayCard() {
            if (state.currentIndex >= state.currentSituations.length) {
                if (state.reviewPile.length > 0) {
                    // Do review round
                    state.sessionPhase = 'review';
                    state.currentSituations = shuffle(state.reviewPile);
                    state.reviewPile = [];
                    state.currentIndex = 0;
                    updateSessionPhaseDisplay();
                } else {
                    endSession();
                    return;
                }
            }

            // Check if we've passed warmup
            if (state.sessionPhase === 'warmup' && state.currentIndex >= state.warmupCount) {
                state.sessionPhase = 'main';
                updateSessionPhaseDisplay();
            }

            const situation = state.currentSituations[state.currentIndex];
            urduEl.textContent = situation.urdu;
            englishEl.textContent = situation.english;
            tenseLabelEl.textContent = situation.tense;
            explanationEl.textContent = situation.explanation;

            answerSection.classList.remove('visible');
            buttons.classList.remove('visible');
            tapHint.style.display = 'block';
            card.classList.remove('revealed');
            state.revealed = false;

            const progress = (state.currentIndex / state.currentSituations.length) * 100;
            progressEl.style.width = progress + '%';
        }

        function revealAnswer() {
            if (state.revealed) return;
            state.revealed = true;
            card.classList.add('revealed');
            answerSection.classList.add('visible');
            buttons.classList.add('visible');
            tapHint.style.display = 'none';
        }

        function hideAnswer() {
            if (!state.revealed) return;
            state.revealed = false;
            card.classList.remove('revealed');
            answerSection.classList.remove('visible');
            buttons.classList.remove('visible');
            tapHint.style.display = 'block';
        }

        function markWrong() {
            const situation = state.currentSituations[state.currentIndex];
            state.reviewPile.push(situation);
            addToReviewQueue(situation);
            updateCategoryStats(situation.category, false);
            state.sessionTotal++;
            state.currentIndex++;
            displayCard();
        }

        function markRight() {
            const situation = state.currentSituations[state.currentIndex];
            removeFromReviewQueue(situation);
            updateCategoryStats(situation.category, true);
            state.sessionCorrect++;
            state.sessionTotal++;
            state.currentIndex++;
            displayCard();
        }

        function endSession() {
            state.sessionActive = false;
            state.stats.sessionsCompleted++;
            saveStats();

            cardContainer.classList.remove('active');
            sessionSummary.classList.add('active');

            document.getElementById('summary-correct').textContent = state.sessionCorrect;
            document.getElementById('summary-total').textContent = state.sessionTotal;
            const accuracy = state.sessionTotal > 0
                ? Math.round((state.sessionCorrect / state.sessionTotal) * 100)
                : 0;
            document.getElementById('summary-accuracy').textContent = accuracy + '%';

            const summaryAccuracyEl = document.getElementById('summary-accuracy');
            summaryAccuracyEl.className = 'summary-stat-value';
            if (accuracy >= 80) summaryAccuracyEl.classList.add('good');
            else if (accuracy < 60) summaryAccuracyEl.classList.add('needs-work');

            // Show weak areas
            const weakAreas = document.getElementById('weak-areas');
            const weakCategories = Object.entries(state.stats.byCategory)
                .filter(([cat, stats]) => stats.practiced >= 3 && (stats.correct / stats.practiced) < 0.7)
                .sort((a, b) => (a[1].correct / a[1].practiced) - (b[1].correct / b[1].practiced))
                .slice(0, 3);

            if (weakCategories.length > 0) {
                weakAreas.style.display = 'block';
                weakAreas.innerHTML = `
                    <div class="weak-areas-title">Focus Areas:</div>
                    ${weakCategories.map(([cat, stats]) => {
                        const pct = Math.round((stats.correct / stats.practiced) * 100);
                        const name = tenseExplanations[cat]?.name || cat;
                        return `<div class="weak-area-item"><span>${name}</span><span>${pct}%</span></div>`;
                    }).join('')}
                `;
            } else {
                weakAreas.style.display = 'none';
            }

            updatePracticeView();
        }

        function newSession() {
            sessionSummary.classList.remove('active');
            sessionStart.style.display = 'block';
            updatePracticeView();
        }

        function reviewMistakes() {
            if (state.stats.reviewQueue.length === 0) {
                alert('No mistakes to review!');
                return;
            }
            state.currentSituations = shuffle([...state.stats.reviewQueue]);
            state.currentIndex = 0;
            state.sessionCorrect = 0;
            state.sessionTotal = 0;
            state.reviewPile = [];
            state.sessionPhase = 'review';
            state.sessionActive = true;

            sessionSummary.classList.remove('active');
            cardContainer.classList.add('active');
            updateSessionPhaseDisplay();
            displayCard();
        }

        // ========== PROGRESS VIEW ==========
        function updateProgressView() {
            document.getElementById('total-practiced').textContent = state.stats.totalPracticed;
            document.getElementById('sessions-count').textContent = state.stats.sessionsCompleted;

            const accuracy = state.stats.totalPracticed > 0
                ? Math.round((state.stats.totalCorrect / state.stats.totalPracticed) * 100)
                : 0;
            document.getElementById('overall-accuracy').textContent = accuracy + '%';

            const progressList = document.getElementById('tense-progress-list');
            progressList.innerHTML = '';

            Object.entries(tenseExplanations).forEach(([key, tense]) => {
                const stats = state.stats.byCategory[key] || { practiced: 0, correct: 0 };
                const pct = stats.practiced > 0 ? Math.round((stats.correct / stats.practiced) * 100) : 0;

                let fillClass = 'low';
                if (pct >= 80) fillClass = 'high';
                else if (pct >= 60) fillClass = 'medium';

                const item = document.createElement('div');
                item.className = 'tense-progress-item';
                item.innerHTML = `
                    <div class="tense-progress-header">
                        <span class="tense-progress-name">${tense.name}</span>
                        <span class="tense-progress-percent">${stats.practiced > 0 ? pct + '%' : 'Not practiced'}</span>
                    </div>
                    <div class="tense-progress-bar">
                        <div class="tense-progress-fill ${fillClass}" style="width: ${pct}%"></div>
                    </div>
                `;
                progressList.appendChild(item);
            });
        }

        function resetProgress() {
            if (confirm('Are you sure you want to reset all progress? This cannot be undone.')) {
                localStorage.removeItem('tenseStats');
                state.stats = loadStats();
                updateProgressView();
                updatePracticeView();
            }
        }

        // ========== UTILITIES ==========
        function shuffle(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        // ========== EVENT LISTENERS ==========
        document.getElementById('btn-start').addEventListener('click', startSession);
        document.getElementById('btn-new-session').addEventListener('click', newSession);
        document.getElementById('btn-review-mistakes').addEventListener('click', reviewMistakes);
        document.getElementById('btn-reset').addEventListener('click', resetProgress);

        card.addEventListener('click', (e) => {
            if (!state.revealed && !e.target.classList.contains('btn')) {
                revealAnswer();
            }
        });

        answerSection.addEventListener('click', (e) => {
            if (e.target.classList.contains('btn')) return;
            e.stopPropagation();
            hideAnswer();
        });

        btnWrong.addEventListener('click', (e) => {
            e.stopPropagation();
            markWrong();
        });

        btnRight.addEventListener('click', (e) => {
            e.stopPropagation();
            markRight();
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (!state.sessionActive) return;

            if (e.code === 'Space') {
                e.preventDefault();
                if (!state.revealed) revealAnswer();
            } else if (e.code === 'ArrowLeft' && state.revealed) {
                markWrong();
            } else if (e.code === 'ArrowRight' && state.revealed) {
                markRight();
            }
        });

        // ========== INITIALIZE ==========
        renderLearnView();
        renderLevels();
        updatePracticeView();
    </script>
</body>
</html>
